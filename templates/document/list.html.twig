{% extends 'base.html.twig' %}

{% block title %}Documents for
	{{ client }}
	- DocManager
{% endblock %}

{% block body %}
	<div class="page-header">
		<h1>üìÑ Documents ‚Äî
			{{ client.firstName }}
			{{ client.lastName }}</h1>
		<div class="page-header-actions">
			<a href="{{ path('app_document_new', {id: client.id}) }}" class="btn btn-primary">+ Upload Document</a>
			<a href="{{ path('app_client_show', {id: client.id}) }}" class="btn btn-secondary">‚Üê Back to Client</a>
		</div>
	</div>

	{% if documents is empty %}
		<div class="card">
			<div class="empty-state">
				<div class="empty-state-icon">üìÇ</div>
				<h3>No documents yet</h3>
				<p>Upload the first document for
					{{ client.firstName }}.</p>
				<a href="{{ path('app_document_new', {id: client.id}) }}" class="btn btn-primary">+ Upload Document</a>
			</div>
		</div>
	{% else %}
		<div class="table-wrapper">
			<div class="table-responsive">
				<table>
					<thead>
						<tr>
							<th>Title</th>
							<th>File</th>
							<th>Type</th>
							<th>Size</th>
							<th>Category</th>
							<th>Uploaded</th>
							<th>Actions</th>
						</tr>
					</thead>
					<tbody>
						{% for doc in documents %}
							<tr>
								<td>
									<a href="{{ path('app_document_show', {id: doc.id}) }}" style="font-weight:600;">{{ doc.title }}</a>
								</td>
								<td style="color:#64748b; font-size:0.85rem; max-width:180px; overflow:hidden; text-overflow:ellipsis; white-space:nowrap;">{{ doc.originalName ?? doc.fileName ?? '‚Äî' }}</td>
								<td>
									<span class="badge badge-primary">{{ doc.mimeType ?? '‚Äî' }}</span>
								</td>
								<td>
									{% if doc.size %}
										{{ (doc.size / 1024)|number_format(1) }}
										KB
									{% else %}
										<span style="color:#94a3b8">‚Äî</span>
									{% endif %}
								</td>
								<td>
									{% if doc.category %}
										<span class="badge badge-success">{{ doc.category.name }}</span>
									{% else %}
										<span style="color:#94a3b8">‚Äî</span>
									{% endif %}
								</td>
								<td style="color:#64748b; font-size:0.85rem;">{{ doc.createdAt|date('d/m/Y H:i') }}</td>
								<td>
									<div style="display:flex; gap:0.35rem; flex-wrap:wrap;">
										<a href="{{ path('app_document_download', {id: doc.id}) }}" class="btn btn-success btn-sm">‚¨á</a>
										<a href="{{ path('app_document_show', {id: doc.id}) }}" class="btn btn-secondary btn-sm">View</a>
										<form method="post" action="{{ path('app_document_delete', {id: doc.id}) }}" class="inline-form" onsubmit="return confirm('Delete this document?');">
											<input type="hidden" name="_token" value="{{ csrf_token('delete-document-' ~ doc.id) }}">
											<button type="submit" class="btn btn-danger btn-sm">üóë</button>
										</form>
									</div>
								</td>
							</tr>
						{% endfor %}
					</tbody>
				</table>
			</div>
		</div>
	{% endif %}
{% endblock %}
